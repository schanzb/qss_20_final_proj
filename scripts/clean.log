2026-02-20 01:43:53,618  INFO      ============================================================
2026-02-20 01:43:53,618  INFO      Citizens United Cleaning Pipeline — 02_clean.py
2026-02-20 01:43:53,618  INFO      Database: /dartfs-hpc/rc/lab/N/NyhanB/bds_playground/data/citizens_united.db
2026-02-20 01:43:53,618  INFO      ============================================================
2026-02-20 01:43:57,699  INFO      All required raw tables present. Starting cleaning pipeline …

2026-02-20 01:43:57,700  INFO      Creating pres_candidates …
2026-02-20 01:43:57,703  INFO        CREATE TABLE pres_candidates …
2026-02-20 01:43:57,739  INFO          done in 0.0s
2026-02-20 01:43:57,743  INFO        2774 presidential candidate records across all cycles
2026-02-20 01:43:57,746  INFO          2004 Party=3: 54 candidates
2026-02-20 01:43:57,746  INFO          2004 Party=D: 74 candidates
2026-02-20 01:43:57,746  INFO          2004 Party=I: 52 candidates
2026-02-20 01:43:57,746  INFO          2004 Party=L: 7 candidates
2026-02-20 01:43:57,746  INFO          2004 Party=R: 31 candidates
2026-02-20 01:43:57,746  INFO          2004 Party=U: 24 candidates
2026-02-20 01:43:57,746  INFO          2008 Party=3: 87 candidates
2026-02-20 01:43:57,746  INFO          2008 Party=D: 75 candidates
2026-02-20 01:43:57,746  INFO          2008 Party=I: 94 candidates
2026-02-20 01:43:57,746  INFO          2008 Party=L: 15 candidates
2026-02-20 01:43:57,746  INFO          2008 Party=R: 92 candidates
2026-02-20 01:43:57,746  INFO          2008 Party=U: 17 candidates
2026-02-20 01:43:57,746  INFO          2012 Party=3: 158 candidates
2026-02-20 01:43:57,746  INFO          2012 Party=D: 71 candidates
2026-02-20 01:43:57,746  INFO          2012 Party=I: 128 candidates
2026-02-20 01:43:57,746  INFO          2012 Party=L: 21 candidates
2026-02-20 01:43:57,746  INFO          2012 Party=R: 161 candidates
2026-02-20 01:43:57,746  INFO          2012 Party=U: 38 candidates
2026-02-20 01:43:57,746  INFO          2020 Party=3: 423 candidates
2026-02-20 01:43:57,746  INFO          2020 Party=D: 402 candidates
2026-02-20 01:43:57,746  INFO          2020 Party=I: 356 candidates
2026-02-20 01:43:57,746  INFO          2020 Party=L: 74 candidates
2026-02-20 01:43:57,746  INFO          2020 Party=R: 237 candidates
2026-02-20 01:43:57,746  INFO          2020 Party=U: 83 candidates
2026-02-20 01:43:57,746  INFO      
2026-02-20 01:43:57,746  INFO      Creating indivs_to_pres …
2026-02-20 01:43:57,750  INFO        CREATE TABLE indivs_to_pres …
2026-02-20 01:44:52,034  INFO          done in 54.3s
2026-02-20 01:44:52,084  INFO        8,155,605 individual contribution records to presidential candidates
2026-02-20 01:44:54,155  INFO          2004:  540,175 records, $0.70B (2024 $)
2026-02-20 01:44:54,175  INFO          2008: 1,107,376 records, $1.05B (2024 $)
2026-02-20 01:44:54,176  INFO          2012: 1,141,271 records, $1.00B (2024 $)
2026-02-20 01:44:54,176  INFO          2020: 5,366,783 records, $0.96B (2024 $)
2026-02-20 01:44:54,176  INFO      
2026-02-20 01:44:54,176  INFO      Creating pacs_to_pres …
2026-02-20 01:44:54,191  INFO        CREATE TABLE pacs_to_pres …
2026-02-20 01:44:57,627  INFO          done in 3.4s
2026-02-20 01:44:57,630  INFO        120,463 PAC contribution/IE records to presidential candidates
2026-02-20 01:44:57,673  INFO          2004 DI=D:    1,592 records, $0.006B (2024 $)
2026-02-20 01:44:57,673  INFO          2004 DI=I:   11,773 records, $0.402B (2024 $)
2026-02-20 01:44:57,673  INFO          2008 DI=D:    1,450 records, $0.005B (2024 $)
2026-02-20 01:44:57,673  INFO          2008 DI=I:   15,744 records, $0.330B (2024 $)
2026-02-20 01:44:57,673  INFO          2012 DI=D:      745 records, $0.003B (2024 $)
2026-02-20 01:44:57,673  INFO          2012 DI=I:   54,490 records, $0.891B (2024 $)
2026-02-20 01:44:57,673  INFO          2020 DI=D:      769 records, $0.002B (2024 $)
2026-02-20 01:44:57,673  INFO          2020 DI=I:   23,611 records, $1.386B (2024 $)
2026-02-20 01:44:57,673  INFO      
2026-02-20 01:44:57,673  INFO      Creating exp527_aligned …
2026-02-20 01:44:57,777  INFO        CREATE TABLE exp527_aligned …
2026-02-20 01:45:10,354  INFO          done in 12.6s
2026-02-20 01:45:10,364  INFO        1,336,399 527 expenditure records (federal, relevant cycles)
2026-02-20 01:45:10,951  INFO          2004 pro_D       :   21,846 records, $0.595B (2024 $)
2026-02-20 01:45:10,955  INFO          2004 pro_R       :    9,395 records, $0.178B (2024 $)
2026-02-20 01:45:10,955  INFO          2004 unaligned   :    3,602 records, $0.023B (2024 $)
2026-02-20 01:45:10,955  INFO          2008 pro_D       :   32,089 records, $0.213B (2024 $)
2026-02-20 01:45:10,955  INFO          2008 pro_R       :    8,592 records, $0.099B (2024 $)
2026-02-20 01:45:10,955  INFO          2008 unaligned   :    4,375 records, $0.014B (2024 $)
2026-02-20 01:45:10,955  INFO          2012 pro_D       :   51,795 records, $0.114B (2024 $)
2026-02-20 01:45:10,955  INFO          2012 pro_R       :   10,359 records, $0.065B (2024 $)
2026-02-20 01:45:10,955  INFO          2012 unaligned   :    2,692 records, $0.018B (2024 $)
2026-02-20 01:45:10,955  INFO          2020 pro_D       : 1,177,545 records, $0.523B (2024 $)
2026-02-20 01:45:10,955  INFO          2020 pro_R       :    9,793 records, $0.046B (2024 $)
2026-02-20 01:45:10,955  INFO          2020 unaligned   :    4,316 records, $0.032B (2024 $)
2026-02-20 01:45:10,955  INFO      
2026-02-20 01:45:10,955  INFO      Creating partisan_spending_monthly …
2026-02-20 01:45:10,960  INFO        CREATE TABLE partisan_spending_monthly …
2026-02-20 01:45:24,122  INFO          done in 13.2s
2026-02-20 01:45:24,127  INFO        1,023 monthly spending aggregate rows
2026-02-20 01:45:24,127  INFO        Summary by era and partisan direction (2024 $B):
2026-02-20 01:45:24,129  INFO          post_CU    pro_D       : $2.79B
2026-02-20 01:45:24,129  INFO          post_CU    pro_R       : $2.20B
2026-02-20 01:45:24,129  INFO          post_CU    unaligned   : $0.06B
2026-02-20 01:45:24,130  INFO          pre_CU     pro_D       : $2.30B
2026-02-20 01:45:24,130  INFO          pre_CU     pro_R       : $1.26B
2026-02-20 01:45:24,130  INFO          pre_CU     unaligned   : $0.04B
2026-02-20 01:45:24,130  INFO      
2026-02-20 01:45:24,130  INFO      Creating partisan_spending_weekly …
2026-02-20 01:45:24,134  INFO        CREATE TABLE partisan_spending_weekly …
2026-02-20 01:45:41,236  INFO          done in 17.1s
2026-02-20 01:45:41,241  INFO        3,934 weekly spending aggregate rows
2026-02-20 01:45:41,241  INFO      
2026-02-20 01:45:41,241  INFO      Creating derived table indexes …
2026-02-20 01:45:57,196  INFO        23 derived indexes created
2026-02-20 01:45:57,196  INFO      
2026-02-20 01:45:57,196  INFO      ============================================================
2026-02-20 01:45:57,196  INFO      VALIDATION — derived table checks
2026-02-20 01:45:57,196  INFO      ============================================================
2026-02-20 01:45:57,210  INFO        [PASS] pres_candidates has rows: 2774 (expected >= 5)
2026-02-20 01:45:57,218  INFO        [PASS] All expected eras present: 2 (expected == 2)
2026-02-20 01:45:57,218  INFO        Key candidate presence check:
2026-02-20 01:45:57,223  INFO          G.W. Bush (2004): FOUND
2026-02-20 01:45:57,231  INFO          Obama (2008): FOUND
2026-02-20 01:45:57,238  INFO          Obama (2012): FOUND
2026-02-20 01:45:57,245  INFO          Biden (2020): FOUND
2026-02-20 01:45:57,252  INFO          Trump (2020): FOUND
2026-02-20 01:45:58,258  INFO        [PASS] No PAC-recipient rows in indivs_to_pres: 0 (expected == 0)
2026-02-20 01:45:59,032  INFO        [PASS] indivs_to_pres has only known eras: 0 (expected == 0)
2026-02-20 01:45:59,043  INFO        [PASS] pacs_to_pres has only known eras: 0 (expected == 0)
2026-02-20 01:45:59,472  INFO        [PASS] indivs partisan coverage (pro_R + pro_D fraction): 0.9978228469868269 (expected >= 0.9)
2026-02-20 01:45:59,473  INFO        Partisan spending totals (2024 $B):
2026-02-20 01:45:59,476  INFO          post_CU    pro_D       : $2.79B
2026-02-20 01:45:59,476  INFO          post_CU    pro_R       : $2.2B
2026-02-20 01:45:59,476  INFO          post_CU    unaligned   : $0.06B
2026-02-20 01:45:59,476  INFO          pre_CU     pro_D       : $2.3B
2026-02-20 01:45:59,476  INFO          pre_CU     pro_R       : $1.26B
2026-02-20 01:45:59,476  INFO          pre_CU     unaligned   : $0.04B
2026-02-20 01:45:59,588  INFO        [PASS] exp527_aligned has all 4 cycles: 4 (expected == 4)
2026-02-20 01:45:59,590  INFO        [PASS] partisan_spending_monthly has rows: 1023 (expected >= 1)
2026-02-20 01:45:59,593  INFO        [PASS] partisan_spending_weekly has rows: 3934 (expected >= 1)
2026-02-20 01:45:59,593  INFO      
  Results: 9 passed, 0 failed
2026-02-20 01:45:59,593  INFO      ============================================================
2026-02-20 01:46:00,676  INFO      
Cleaning pipeline complete in 2.1 minutes.
2026-02-20 01:46:00,676  INFO      Next step: run  python scripts/03_q1_spending.py
